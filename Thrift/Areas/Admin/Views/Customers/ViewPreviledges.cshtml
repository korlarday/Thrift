@model Thrift.Areas.Admin.Models.AuthorizeVM

@{
    ViewBag.Title = "ViewPreviledges";
}

<div class="container-fluid">
    <div class="block-header">
        <h2>User Previledges</h2>
    </div>
    <div class="row clearfix">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="card">
                <div class="header">
                    <h2>
                        Previledges for (@Model.Customer.Username)
                    </h2>
                    <a href="/Admin/Customers/manage-users" class="btn bg-teal waves-effect right" style="position: relative; top: -25px">Back</a>
                </div>
                <div class="body">
                    <div class="row">
                        @if (TempData["SM"] != null)
                        {
                            <div class="alert bg-green">
                                @TempData["SM"]
                            </div>
                        }
                        <div class="col-md-2">
                            <div>
                                <img style="width: 100%" src="/Images/Uploads/Passports/@Model.Customer.Id/Thumbs/@Model.Customer.PassportName" alt="passport" />
                            </div>
                        </div>
                        <div class="col-md-6 col-md-offset-1">
                            <div class="table-responsive">
                                <table class="table">
                                    <tbody>
                                        <tr>
                                            <th>Name</th>
                                            <td>@Model.Customer.FirstName @Model.Customer.LastName</td>
                                        </tr>
                                        <tr>
                                            <th>Username</th>
                                            <td id="username">@Model.Customer.Username</td>
                                        </tr>
                                        <tr>
                                            <th>Address</th>
                                            <td>@Model.Customer.Address</td>
                                        </tr>
                                        <tr>
                                            <th>Email</th>
                                            <td>@Model.Customer.Email</td>
                                        </tr>
                                        <tr>
                                            <th>Phone Number</th>
                                            <td>@Model.Customer.PhoneNumber</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-md-offset-3">
                            <div class="form-horizontal">
                                <h4>Previledges</h4>
                                <div class="demo-checkbox">
                                    <input type="checkbox" class="filled-in" id="admin" checked="@Model.Admin" />
                                    <label for="admin">Administrator</label>
                                </div>
                                <input type="hidden" id="cusId" value="@Model.Customer.Id" />
                                <div class="demo-checkbox">
                                    <input type="checkbox" id="allocation" class="filled-in" checked="@Model.Allocation" />
                                    <label for="allocation">Customer Allocation</label>
                                </div>

                                <div class="demo-checkbox">
                                    <input type="checkbox" id="all" class="filled-in" checked="@Model.All" />
                                    <label for="all">No Customer Restriction</label>
                                </div>

                                <div class="demo-checkbox">
                                    <input type="checkbox" id="investment" class="filled-in" checked="@Model.Investment" />
                                    <label for="investment">Investment</label>
                                </div>


                                <div class="form-group">
                                    <div class="col-md-offset-2 col-md-10">
                                        <button type="button" id="submit" class="btn bg-success">Save</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        $(function () {
            function formatMoney(n, c, d, t) {
                var c = isNaN(c = Math.abs(c)) ? 2 : c,
                    d = d == undefined ? "." : d,
                    t = t == undefined ? "," : t,
                    s = n < 0 ? "-" : "",
                    i = String(parseInt(n = Math.abs(Number(n) || 0).toFixed(c))),
                    j = (j = i.length) > 3 ? j % 3 : 0;

                return s +
                    (j ? i.substr(0, j) + t : "") +
                    i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) +
                    (c ? d + Math.abs(n - i).toFixed(c).slice(2) : "");
            };
            $(".moneyValue").each(function () {
                var $this = $(this);
                var $money = $this.text();
                $money = formatMoney($money);
                $this.text($money);
            })

            $("#submit").on("click", function (e) {
                e.preventDefault();
                var admin = $("#admin").prop('checked');
                var allocation = $("#allocation").prop('checked');
                var all = $("#all").prop('checked');
                var investment = $("#investment").prop('checked');
                var id = $("#cusId").val();
                var username = $("#username").text();
                var obj = {
                    Admin: admin,
                    Allocation: allocation,
                    All: all,
                    Id: id,
                    Investment: investment,
                    Username: username
                };
                $.ajax({
                    url: "/Admin/Customers/SetPrevideges",
                    type: "POST",
                    data: { model: obj },
                    success: function (data) {
                        location.reload();
                    },
                    error: function () {
                        alert("Unable to set previledges");
                    }
                })
            })
        });
    </script>
}



